ã“ã®è¨˜äº‹ã¯ [UMITRON Advent Calendar 2021](https://adventar.org/calendars/6652) **6æ—¥ç›®** ã®è¨˜äº‹ã§ã™ã€‚

æœèµ·ãã‚‹ã¾ã§ã¯æ–­å›ºã¨ã—ã¦ **6æ—¥ç›®** ã§ã™ğŸŒ…

---

ãŠé­šé£Ÿã¹ã¦ã¾ã™ã‹?

æ”¹ã‚ã¾ã—ã¦ tearoom6 ã§ã™ã€‚
ç¾åœ¨ã¯ UMITRON æ ªå¼ä¼šç¤¾ã§ã€é¤Šæ®–ã®æµ·æ´‹ç”Ÿç‰© ğŸŸ ã®æŒã¤æ½œåœ¨çš„å¯èƒ½æ€§ã‚’ IT ã‚’ä½¿ã£ã¦å¼•ãå‡ºã™ã“ã¨ã«å–ã‚Šçµ„ã‚“ã§ã„ã¾ã™ã€‚

ã•ã¦ã€æ—¥ã€…é–‹ç™ºã‚’è¡Œã£ã¦ã„ã‚‹ã¨ã€ã©ã†ã—ã¦ã‚‚å„ªå…ˆåº¦ä»˜ã‘ã§å¾Œå›ã—ã«ãªã‚‹ã‚¿ã‚¹ã‚¯ã¯ã‚ã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ã«ç›´æ¥ä¾¡å€¤ã‚’æä¾›ã—ãªã„ã‘ã©ã€ç´°ã‹ã„ã¨ã“ã‚ã§ä¸ä¾¿ã‚’æ„Ÿã˜ã‚‹ã€ã‚ã£ãŸã‚‰ä¾¿åˆ©ãªã‚“ã ã‘ã©ãªãã€ã€ã¨ã„ã†é¡ã®ã‚‚ã®ã§ã™ã­ã€‚ã»ã‚“ã¨ã«ã™ãã§ãã‚‹ã‚‚ã®ã¯ã•ã£ã¨ä½œã£ã¡ã‚ƒã†ã»ã†ãŒè‰¯ã„ã‹ã¨æ€ã„ã¾ã™ã‘ã©ã€å®Ÿéš›ã«ã»ã‚“ã¨ã«ã™ãã§ãã¡ã‚ƒã†ã‚‚ã®ã¯å®Ÿã¯ãã‚“ãªã«å¤šããªã„ã‹ã¨æ€ã„ã¾ã™ã€‚

ãã†ã„ã†å ´åˆã€ã¾ãšã¯æ—¢ã«ä¸–ã®ä¸­ã«ã‚ã‚‹ã‚‚ã®ã§ä½¿ãˆãã†ãªã‚‚ã®ãŒãªã„ã‹æ¢ã—ã¾ã™ãŒã€ã±ã£ã¨æ¢ã—ã¦ã€è‰¯ã„ã‚‚ã®ãŒç„¡ã‹ã£ãŸå ´åˆã¯ã€è‡ªåˆ†ã§ä½œã‚‹ã‹ã€ã¨æ€ã„ã¤ã¤ã€å¡©æ¼¬ã‘ã«ãªã‚ŠãŒã¡ã§ã™ã€‚

ãŸã ã€ã“ã†ã„ã†é–‹ç™ºæ”¯æ´çš„ãªã‚¿ã‚¹ã‚¯ã¯ã€åˆ¶ç´„ãŒå¼·ããªãã¦ã€æ¯”è¼ƒçš„è‡ªç”±ã«ã§ãã‚‹ã®ã§ã€æŠ€è¡“çš„ãƒã‚¦ãƒã‚¦ãŒæºœã¾ã‚Šã‚„ã™ã„ã¨æ„Ÿã˜ã¦ã„ã‚‹ã®ã‚‚ã‚ã£ã¦ã€ã§ãã‚‹ãªã‚‰ä¸¦è¡Œã—ã¦é€²ã‚ãŸã„æ°—æŒã¡ãŒã‚ã‚Šã¾ã™ã€‚ (ä½•ã‚ˆã‚Šã‚‚ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã¯ä½•ã§ã‚‚è‡ªå‹•åŒ–ã—ãŸãŒã‚‹ã®ãŒç¿’æ€§ã§ã™ã—ãƒ»ãƒ»ãƒ»)

ãã“ã§ã€è¡¨é¡Œã® "Advent calendar driven development" ã§ã™ã€‚
Advent calendar ã§å®£è¨€ã—ã¦ã€ãã®æ—¥ (**6æ—¥ç›®** ã§ã™) ã¾ã§ã«å¿…ãšã‚„ã‚‹ãã¨ãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼ã‚’ä¸ãˆã‚‹ã“ã¨ã§ã€ãã®æ‰‹ã®ã‚¿ã‚¹ã‚¯ã‚’ã“ãªãã†ã¨ã™ã‚‹ã‚‚ã®ã§ã™ã€‚

## æœ¬é¡Œ - å®Ÿç¾ã—ãŸã„æ©Ÿèƒ½

å‰ç½®ãé•·ããªã‚Šã¾ã—ãŸãŒã€ä»¥ä¸‹ã€æœ¬é¡Œã§ã™ã€‚

ç§ã®é–¢ã‚ã£ã¦ã„ã‚‹ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã§ã¯ã€ç”»é¢ã‚’è¦‹ã¦ã„ã¦ UTC ã§è¨˜éŒ²ã—ã¦ã„ã‚‹æ™‚åˆ»ãŒã€ç¾åœ°ã®ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã§ã¯ä½•æ™‚ã«ãªã‚‹ã®ã ã‚ã†ã€ã¨ã„ã†ã®ã‚’çŸ¥ã‚ŠãŸã„å ´é¢ã«å‡ºãã‚ã™ã“ã¨ãŒå¤šãã‚ã‚Šã¾ã—ãŸã€‚

ã‚‚ã¡ã‚ã‚“ç”»é¢ä¸Šã§è¡¨ç¤ºã™ã‚‹ã‚ˆã†å®Ÿè£…ã—ã¡ã‚ƒã£ã¦ã‚‚ã„ã„ã®ã§ã™ãŒã€ã‚‚ã—ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®æ‹¡å¼µæ©Ÿèƒ½ã§å®Ÿç¾ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ãªã‚‰ã€å†åˆ©ç”¨æ€§ã‚‚ã‚ã‚Šã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ã«ä¿ã¦ã‚‹ã®ã§ã€å®Ÿç¾ã—ãŸã„æ©Ÿèƒ½ã«å¯¾ã—ã¦è¦ªå’Œæ€§ãŒé«˜ã„ã®ã§ã¯ã¨æ€ã„ã¾ã—ãŸã€‚

ã¾ãšã€æ—¢å­˜ã®æ‹¡å¼µæ©Ÿèƒ½ã‚’æ¢ã™ã¨ã“ã‚ã‹ã‚‰å§‹ã‚ãŸã®ã§ã™ãŒã€å…¬é–‹ã•ã‚Œã¦ã„ã‚‹ Chrome ã®æ‹¡å¼µæ©Ÿèƒ½ã ã¨ã€ä»¥ä¸‹ã® 2 ç³»çµ±ãŒå¤šãã€ç›®çš„ã®ã‚‚ã®ãŒãªã‹ãªã‹è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚

- ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒ–ãƒ©ã‚¦ã‚¶ã® timezone ã®è¨­å®šã‚’æ‰‹è»½ã«å¤‰æ›´ã™ã‚‹
- ç¾åœ¨æ™‚åˆ»ã‚’è¤‡æ•° timezone ã®æ™‚åˆ»ã§è¡¨ç¤º (ä¸–ç•Œæ™‚è¨ˆçš„ãª)

ä¸€ç•ªè¿‘ã‹ã£ãŸã®ãŒ [Utime - Chrome Web Store](https://chrome.google.com/webstore/detail/utime/kpcibgnngaaabebmcabmkocdokepdaki) ã¨ã„ã†æ‹¡å¼µæ©Ÿèƒ½ã§ã—ãŸã€‚

[billdami/utime: A Google Chrome extension that converts UNIX timestamps to dates (and vice versa)](https://github.com/billdami/utime)

ã“ã®æ‹¡å¼µæ©Ÿèƒ½ã¯ã€ãƒ†ã‚­ã‚¹ãƒˆã‚’é¸æŠã—ãŸçŠ¶æ…‹ã§ context menu ã‚’æŠ¼ã™ã¨ã€ãã®ãƒ†ã‚­ã‚¹ãƒˆãŒç¤ºã™æ—¥æ™‚ã‚’ã€äº‹å‰ã«è¨­å®šã—ãŸã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã§ã®æ—¥æ™‚ã«å¤‰æ›ã—ãŸä¸Šã§ã€ Notification ã§è¡¨ç¤ºã™ã‚‹ã€ã¨ã„ã†æ©Ÿèƒ½ãªã©ã‚’æä¾›ã—ã¦ã„ã¾ã—ãŸã€‚

![chrome_extension_utime_notification.png](https://files.tearoom6.biz/f04e0507-6ca3-4288-a490-f2f14a444d7d.png)

ã—ã‹ã—ã€å®Ÿç¾ã—ãŸã„ã®ã¯ã€é¸æŠã—ãŸã¨ãã«å¤‰æ›å¯¾è±¡ã®ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã‚’æŒ‡å®šã—ãŸã„ã€ã‚‚ã—ãã¯ã€è¤‡æ•°ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã§ã®æ™‚åˆ»ã‚’è¡¨ç¤ºã—ãŸã„ã€ã€ã¨ã„ã†æ„Ÿã˜ã ã£ãŸã®ã§ã€æƒœã—ã‹ã£ãŸã®ã§ã™ãŒã€ã¡ã‚‡ã£ã¨é•ã†æ„Ÿã˜ã§ã—ãŸã€‚ãªã®ã§ã€ãƒãƒ£ãƒ³ã‚¹ãŒã‚ã‚Œã°è‡ªä½œã—ã‚ˆã†ã‹ãªã¨æ€ã£ã¦ã„ã¾ã—ãŸã€‚

## å‰ææ¡ä»¶

å®Ÿè£…å‰ã®çŠ¶æ³ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªæ„Ÿã˜ã§ã™ã€‚

- Chrome ã®æ‹¡å¼µæ©Ÿèƒ½ã§ã®é–‹ç™ºçµŒé¨“ã¯ã‚ã‚Š
- ã©ã®ã‚ˆã†ãª API ã‚’ä½¿ãˆã°ã€ã©ã®ã‚ˆã†ãªæ©Ÿèƒ½ãŒå®Ÿç¾ã§ãã‚‹ã€ã¨ã„ã†ã‚ˆã†ãªçŸ¥è­˜ãƒ»èª¿æŸ»ã‚’è¡Œã‚ãªã„çŠ¶æ…‹ã§ã€ã¨ã‚Šã‚ãˆãšå®Ÿç¾ã—ãŸã„æ©Ÿèƒ½ã ã‘ã‚ã‚‹çŠ¶æ…‹ã§é–‹å§‹
- [Content scripts](https://developer.chrome.com/docs/extensions/mv3/content_scripts/) ã‚’ä½¿ãˆã°ã€å‰²ã¨ã©ã‚“ãªã“ã¨ã§ã‚‚ã§ãã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã¯ã‚ã£ãŸãŒã€ã“ã®æ©Ÿèƒ½ã¯ã©ã‚“ãªã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã§ã‚‚ä½¿ãˆã‚‹ã‚ˆã†ã«ã—ãŸã‹ã£ãŸãŸã‚ [Context Menus](https://developer.chrome.com/docs/extensions/reference/contextMenus/) ã‚’ä½¿ã†ã“ã¨ã«ã—ãŸ
- å½“åˆã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã¯ã€ä»¥ä¸‹ã®ã©ã¡ã‚‰ã‹ã§å®Ÿç¾ã§ãã‚Œã°éå¸¸ã«å¬‰ã—ã„ãªã¨ã„ã†æœŸå¾…ã‚’æŒã£ã¦ã„ãŸãŒã€ä»–ã®æ‹¡å¼µæ©Ÿèƒ½ã‚’ä½¿ã£ã¦ã„ã‚‹æ„Ÿè¦šã‹ã‚‰ã™ã‚‹ã¨ã€ãã†ã„ã†æ©Ÿèƒ½ã¯å®Ÿç¾ã§ããªã„ã®ã‹ãªã¨ã„ã†æ°—ã‚‚ã—ã¦ã„ãŸ
  - å¯¾è±¡ã®æ™‚åˆ»æ–‡å­—åˆ—ã‚’é¸æŠã—ãŸçŠ¶æ…‹ã§ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‹ã‘ã°ã€ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼å†…ã«ã€å„ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã§ã®æ™‚åˆ»ãŒè¡¨ç¤ºã•ã‚Œã‚‹
  - å¯¾è±¡ã®æ™‚åˆ»æ–‡å­—åˆ—ã‚’é¸æŠã—ãŸçŠ¶æ…‹ã§ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é¸æŠã™ã‚Œã°ã€æ‹¡å¼µæ©Ÿèƒ½ã® popup ãŒè¡¨ç¤ºã•ã‚Œã€ãã®ä¸­ã§å„ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã§ã®æ™‚åˆ»ãŒè¡¨ç¤ºã•ã‚Œã‚‹

ãªãŠã€ä»Šå›ã¯ã€æ™®æ®µé£ã„ã® Chrome ã®ã¿ã‚’å¯¾è±¡ã«ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚

ç§ã¯ä½œã£ãŸã“ã¨ã¯ãªã„ã§ã™ãŒã€ä»–ã®ä¸»è¦ãƒ¢ãƒ€ãƒ³ãƒ–ãƒ©ã‚¦ã‚¶ã«ã¤ã„ã¦ã‚‚ã€æ‹¡å¼µæ©Ÿèƒ½ã®ä»•çµ„ã¿ã¯ç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚

- [Extensions - Microsoft Edge Developer](https://developer.microsoft.com/en-us/microsoft-edge/extensions/)
- [Browser Extensions - Mozilla | MDN](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions)
- [Safari Web Extensions | Apple Developer Documentation](https://developer.apple.com/documentation/safariservices/safari_web_extensions)

ãŸã ã€ API æ¨™æº–åŒ–ã¯ç¾æ™‚ç‚¹ã§ã¯é“åŠã°ã§ã€äº’æ›æ€§ã®ãªã„ã¨ã“ã‚ã¯ç›¸å½“ã‚ã‚‹ã¨æ€ã‚ã‚Œã¾ã™ã€‚ (ã¤ã¾ã‚Šã€ãªã‹ãªã‹åŒä¸€ã‚³ãƒ¼ãƒ‰ã§ã¯æ›¸ãã®ã¯é›£ã—ãã†ã¨ã„ã†æ„Ÿã˜ãŒã—ã¾ã™)

- [About the WebExtensions API | Firefox Extension Workshop](https://extensionworkshop.com/documentation/develop/about-the-webextensions-api/)
- [Chrome incompatibilities - Mozilla | MDN](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Chrome_incompatibilities)
- [Porting a Google Chrome extension | Firefox Extension Workshop](https://extensionworkshop.com/documentation/develop/porting-a-google-chrome-extension/)

## å®Ÿè£…æ–¹é‡

å…¨ä½“ã¨ã—ã¦ã¯ã€ä»¥ä¸‹ã®æ–¹é‡ã‚’æŒã£ã¦ã„ã¾ã—ãŸã€‚

- TypeScript ã§å®Ÿè£…ã—ã¦ãŠã
- ç”»é¢ãŒå¿…è¦ãªã‚‰ React ã‚’ç”¨ã„ã‚‹ (çµæœçš„ã«ã¯ç”»é¢ã¯ä½œã£ã¦ã„ãªã„)

ã¾ãŸã€æ™‚é–“ã®ãªã„ä¸­ä½œã‚‹ã®ã§ã€ã¨ã‚Šã‚ãˆãšè’å‰Šã‚Šã§ã‚‚ OK ã¨ã„ã†ã“ã¨ã«ã—ã¾ã—ãŸã€‚

ã¾ãŸã€ MV3 (Manifest V3 for Chrome Extensions) ã¨å‘¼ã°ã‚Œã‚‹ Chrome Extensions API ã®æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒä½¿ãˆã‚‹ã®ã§ã€ãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ³ã‚°ãªè¦ç´ ã¨ã—ã¦ã€ãã¡ã‚‰ã§å®Ÿè£…ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚

MV2 ã¨ MV3 ã¯ã€ä¾‹ãˆã°ä»¥ä¸‹ã®ã‚ˆã†ãªé•ã„ãŒã‚ã‚Šã¾ã™ã€‚

- Browser Action API ã¨ Page Action API ãŒ Action API ã«çµ±åˆã•ã‚ŒãŸ
- background pages ã¨å‘¼ã°ã‚Œã¦ã„ãŸ headless ã§å‹•ãéƒ¨åˆ†ã¯ service workers ã§å®Ÿè£…ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„
- Remotely hosted code ãŒå®Ÿè¡Œã§ããªããªã£ãŸ

[Chrome Extension Tutorial: Migrating to Manifest V3 from V2](https://blog.shahednasser.com/chrome-extension-tutorial-migrating-to-manifest-v3-from-v2/)

æ©Ÿèƒ½çš„ã«å‘ä¸Šã—ãŸã¨ã„ã†ã‚ˆã‚Šã¯ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚„ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹é¢ã«é…æ…®ã—ãŸã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆãŒä¸­å¿ƒãªæ°—ãŒã—ã¾ã™ã€‚ãŸã ã€ä»Š MV2 ã§å‹•ã„ã¦ã„ã‚‹æ‹¡å¼µæ©Ÿèƒ½ã¯ 2022 å¹´ä¸­ã® MV3 ã¸ã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆãŒæ±‚ã‚ã‚‰ã‚Œã¦ã„ã‚‹ã®ã§ã€æ‹¡å¼µæ©Ÿèƒ½é–‹ç™ºè€…ã¯å¯¾å¿œã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

[Manifest V2 support timeline - Chrome Developers](https://developer.chrome.com/docs/extensions/mv3/mv2-sunset/)

â€» ä½™è«‡ã§ã™ãŒã€ä¸€æ˜”å‰ã¯ Chrome Web Store ã¸ã®æ‹¡å¼µæ©Ÿèƒ½ã®å…¬é–‹ã¯ã€å‰²ã¨ãƒãƒ¼ãƒ‰ãƒ«ãŒä½ã‹ã£ãŸã®ã§ã™ãŒã€ä»Šã¯ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚‚å³æ ¼ã§ã€çµæ§‹å³ã—ããªã£ã¦ã„ã‚‹æ°—ãŒã—ã¾ã—ãŸã€‚ã¾ãã€æ‹¡å¼µæ©Ÿèƒ½ã£ã¦çµæ§‹ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£çš„ã«ã¯å³æ ¼ã«ã—ãªã„ã¨å±ãªã„ã‚ˆã­ã€ã£ã¦ã„ã†æ°—ã¯ã—ã¦ã¾ã—ãŸãŒã€‚ã€‚

## å®Ÿè£…çµæœã¨çŸ¥è¦‹

ã“ã¡ã‚‰ãŒã¨ã‚Šã‚ãˆãšä½œã£ãŸã‚³ãƒ¼ãƒ‰ã§ã™ã€‚

https://github.com/tearoom6/TimezoneTraveler

![chrome_extension_timezone_traveler_usage.png](https://files.tearoom6.biz/d7852806-38da-44a2-bd47-c6be8001a163.png)

çµæœçš„ã«å‡ºæ¥ä¸ŠãŒã£ãŸã‚‚ã®ã¯ã€ "å¯¾è±¡ã®æ™‚åˆ»æ–‡å­—åˆ—ã‚’é¸æŠã—ãŸçŠ¶æ…‹ã§ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é¸æŠã™ã‚Œã°ã€å†åº¦ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‹ã„ãŸéš›ã«ã€å„ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã§ã®æ™‚åˆ»ãŒè¡¨ç¤ºã•ã‚Œã‚‹" ã¨ã„ã†ã‚‚ã®ã§ã€ã“ã‚Œã ã¨ã€ç›®çš„ã®å„ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã§ã®æ—¥æ™‚ã‚’è¡¨ç¤ºã™ã‚‹ã®ã« 2 ã‚¯ãƒªãƒƒã‚¯ (+ ã‚«ãƒ¼ã‚½ãƒ«ã®ç§»å‹• = ã“ã‚Œã¯ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚­ãƒ¼ã‚’è¨­å®šã™ã‚Œã°ã€å›é¿ã§ãã‚‹ã‹ã‚‚) ã‚’è¦ã™ã‚‹ã®ã§ã€ä½¿ã„å‹æ‰‹ã¨ã—ã¦ã¯ã‹ãªã‚Šæ‚ªãã€ã•ã‚‰ãªã‚‹æ”¹è‰¯ã¯å¿…è¦ãã†ã§ã™ã€‚

ãƒ–ãƒ©ã‚¦ã‚¶ã®æ‹¡å¼µæ©Ÿèƒ½ã¯ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£çš„ãªè¦ä»¶ã‹ã‚‰åˆ¶ç´„ãŒå¼·ã„ã®ã§ã€ã©ã†ã—ã¦ã‚‚å®Ÿéš›ã«ä½œã‚ŠãªãŒã‚‰ã€å®Ÿç¾ã§ããã†ãªãƒ©ã‚¤ãƒ³ã‚’æ¢ã£ã¦ã„ãæ„Ÿã˜ã«ãªã£ã¡ã‚ƒã„ã¾ã™ã­ã€‚ã€‚
ãã‚Œã‚‚æ•°ã‚’ã“ãªã›ã°ã€å¤§ä½“å‹˜æ‰€ã¯æ´ã‚ã¦ãã‚‹ã‚“ã§ã—ã‚‡ã†ã‘ã©ãƒ»ãƒ»ãƒ»ã€‚

å®Ÿè£…ä¸Šã®è‹¦åŠ´ã—ãŸãƒã‚¤ãƒ³ãƒˆã¯ä»¥ä¸‹ã®ã¨ãŠã‚Šã§ã™ã€‚

### service worker ã«èµ·å› ã™ã‚‹å•é¡Œ

service worker ã¯å¿…è¦ãªã¨ãã«ã ã‘ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã€å‹•ä½œã™ã‚‹ã¨ã„ã†ç‰¹æ€§ã‚’æŒã¤ãŸã‚ã€ã„ãã¤ã‹ã®ãƒ«ãƒ¼ãƒ«ã‚’å®ˆã£ã¦å®Ÿè£…ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

- event listeners ã®ç™»éŒ²ã¯ top level ã§è¡Œã† (éåŒæœŸ callback ã®ä¸­ãªã©ã§è¡Œã‚ãªã„)
- global variable ã®çŠ¶æ…‹ã¯ã€ã™ãã«ãƒªã‚»ãƒƒãƒˆã•ã‚Œã¦ã—ã¾ã†å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€å¿…è¦ãªã‚‚ã®ã¯ storage ã«æ°¸ç¶šåŒ–ã‚’è¡Œã†
- `setTimeout`, `setInterval` ã®ä»£ã‚ã‚Šã« [Alarms API](https://developer.chrome.com/docs/extensions/reference/alarms/) ã‚’ top level ã§ç”¨ã„ã‚‹

### `chrome.contextMenus`

ã“ã¡ã‚‰ã‚‚å‰²ã¨ã‚¯ã‚»ã®ã‚ã‚‹ API ã§ã—ãŸã€‚

- context menu item ã¯è¦ªå­é–¢ä¿‚ã«ã—ã¦ãƒã‚¹ãƒˆã™ã‚‹ã“ã¨ãŒã§ãã‚‹ãŒã€è¦ªã«ã§ãã‚‹ã®ã¯ `ItemType` ãŒ `normal` ã®ã‚‚ã®ã®ã¿
  - `checkbox`, `radio`, `separator` ã¯è¦ªã«ã™ã‚‹ã“ã¨ãŒã§ããªã„
- è¦ªã«ãªã£ãŸ menu item ã¸ã®ã‚¯ãƒªãƒƒã‚¯ã¯ `OnClick` event ã§æ•æ‰ã§ããªã„
- åŒä¸€ `id` ã® menu item ã¯ç™»éŒ²ã§ããªã„
- å­˜åœ¨ã—ãªã„ `parentId` ã‚’æŒ‡å®šã—ãŸ menu item ã¯ç™»éŒ²ã§ããªã„
- ãƒ†ã‚­ã‚¹ãƒˆé¸æŠæ™‚ã® context menu ã« item ã‚’è¡¨ç¤ºã—ãŸã„å ´åˆã¯ã€å…¨ã¦ã®å¯¾è±¡ item ã® `contexts` ã« `all` or `selection` ã‚’å«ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹
  - è¦ª item ã§æŒ‡å®šã—ã¦ã„ãŸã‹ã‚‰ã¨ã„ã£ã¦ã€å­ item ã§æŒ‡å®šã—ã¦ã„ãªã‘ã‚Œã°ã€å­ item ã®æ–¹ã¯è¡¨ç¤ºã•ã‚Œãªã„

### `browserAction.openPopup()`

å½“åˆã®é‡æœ›ã«ã‚ã£ãŸã€ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼æŠ¼ä¸‹ã§ã€æ‹¡å¼µæ©Ÿèƒ½ã® popup ã‚’è¡¨ç¤ºã€ã¨ã„ã†æ©Ÿèƒ½ãŒå®Ÿç¾ã§ããªã‹ã£ãŸç‚¹ã§ã™ã€‚

Mozilla ã®å‡ºã—ã¦ã„ã‚‹ WebExtensions API ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è¦‹ã¦ã¿ã‚‹ã¨ `browser.browserAction.openPopup()` ã¨ã„ã†ã®ãŒå®Ÿã¯ã‚ã‚‹ã®ã§ã€ Chrome ã§ã‚‚ popup ã‚’ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‹ã‚‰é–‹ã‘ã‚‹ã®ã§ã¯ãªã„ã‹ã¨ã„ã†æœŸå¾…ãŒç”Ÿã¾ã‚ŒãŸã®ã§ã™ãŒã€ã©ã†ã‚‚ Security ã®å•é¡Œã‹ã‚‰ Chrome ã§ã¯ `chrome.browserAction.openPopup()` ã‚’ä¸€èˆ¬å…¬é–‹ã¯ã—ã¦ã„ãªã„ã‚ˆã†ã§ã™ã€‚è©³ç´°ã¯æŠŠæ¡ã—ã¦ã„ãªã„ã§ã™ãŒã€ Security å‘¨ã‚Šã¯ã‹ãªã‚Šæ³¥è‡­ã„å®Ÿè£…ãŒè¡Œã‚ã‚Œã¦ã„ã‚‹ã®ã‹ã‚‚ã—ã‚Œãªã„ã§ã™ã€‚

https://chromium.googlesource.com/chromium/src/+/0ab916c3ef2fd0674d179e2c29b3e6b937231138/chrome/common/extensions/api/_api_features.json#167

ãŸã ã—ã€æ‹¡å¼µæ©Ÿèƒ½ã®ç”»é¢ã‚’ popup ã§ã¯ãªãã€æ–°è¦ã‚¿ãƒ–ã¨ã—ã¦é–‹ãã“ã¨ã¯ (Permission ãŒè¨±ã›ã°) å¯èƒ½ãªã‚ˆã†ãªã®ã§ã€ãã‚Œã‚’ä½¿ãˆã°ã€ã‚‚ã£ã¨ä½¿ã„å‹æ‰‹ã‚’è‰¯ãã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã§ã™ã€‚

[Question How to programmatically open a chrome extension popup window from background.html](https://www.titanwolf.org/Network/q/bc51ed2d-e9db-4698-b476-2f8e34519620/y)

> References

- [TypeScriptã§ä½œã‚‹ã‚¤ãƒãƒ‰ã‚­Chromeæ‹¡å¼µæ©Ÿèƒ½é–‹ç™ºå…¥é–€ - Qiita](https://qiita.com/markey/items/ea9ed18a1a243b39e06e)

---

(è¿½è¨˜)
ãƒ¬ãƒ“ãƒ¥ãƒ¼é€šã£ã¦ Chrome Web Store ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯èƒ½ã«ãªã‚Šã¾ã—ãŸã€‚
ã‚‚ã—ã”èˆˆå‘³æŒã£ãŸæ–¹ãŒã„ã‚Œã°æ”¹å–„ã«ã”å”åŠ›ãŠé¡˜ã„ã—ã¾ã™ğŸ™

https://chrome.google.com/webstore/detail/timezone-traveler/gndkkoonfiibdihdaklkhfiikfkbhdik

---

ä»¥ä¸Šã€6æ—¥ç›®ãŒèª•ç”Ÿæ—¥ã® tearoom6 ã®è¨˜äº‹ã§ã—ãŸ ğŸ‰
